---
title: "Car Analysis"
format: html
editor: visual
---

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

## Running Code

When you click the **Render** button a document will be generated that includes both content and the output of embedded code. You can embed code like this:

car_analysis \<-

```{r}
library(tidyverse)
car_analysis <- read_csv("car_analysis.csv")
```

You can add options to executable code like this

```{r}

            #This is my linear model and summary

carLm <- lm(price~mileage, data=car_analysis)
summary(carLm)


            #Here is the base point plot and line

ggplot(data=car_analysis, mapping = aes(x=mileage, y=price))+
  geom_point()+
  geom_smooth(method="lm", formula=y~x, se=F, col="skyblue")+
  
            #Here is a curved line to visualize the price not going to 0
  
   stat_smooth(method = "lm",formula = y ~ poly(x, 2),se = F,col = "orange",lty = 1)+
  
            #These are my labels and theme
  
  labs(
    x="Mileage",
    y="Price in Dollars",
    title="Car price analysis based on milage"
  )+
  
  theme_minimal()+
  theme(plot.title = element_text(hjust = 0.5))
  
            #this part doesn't paste into the graph cause its on base R
  
```

The `echo: false` option disables the printing of code (only output is displayed).

```{r}
pander(rbind(`Y-Intercept` = c(Estimated = carLm$coef[[1]]),
      Slope = c(Estimated = carLm$coef[[2]]),
      Sigma = c(Estimated = summary(carLm)$sigma)))

                                 #Add summary to plot
legend("topleft", legend=c(paste("Y-Intercept:", round(carLm$coef[[1]], 3), "  (", beta_0, ")"),
                           paste("Slope:", round(carLm$coef[[2]], 3), "  (", beta_1, ")"),
                           paste("Sigma:", round(summary(carLm)$sigma, 3), "  (", sigma, ")")), bty='n')
```
